try{if(!window.injected){values=e=>{const t={zh:{loop:"循环播放",download:"下载",ok:"确定",video:"视频",cover:"封面"},en:{loop:"Loop Play",download:"Download",ok:"OK",video:"Video",cover:"Cover"},ja:{loop:"ループ再生",download:"ダウンロード",ok:"はい",video:"ビデオ",cover:"カバー"},ko:{loop:"반복 재생",download:"시모타코",ok:"확인",video:"비디오",cover:"커버"},fr:{loop:"Lecture en boucle",download:"Télécharger",ok:"D'accord",video:"vidéo",cover:"couverture"}},o=(document.body.lang||"en").substring(0,2).toLowerCase();return t[o]?t[o][e]:t.en[e]},get_page_class=e=>(e=e.toLowerCase()).startsWith("https://m.youtube.com")?e.includes("shorts")?"shorts":e.includes("watch")?"watch":e.includes("library")?"library":e.includes("subscriptions")?"subscriptions":e.includes("@")?"@":"home":"unknown",get_video_id=e=>{try{const t=e.match(/watch\?v=([^&#]+)/);return t?t[1]:null}catch(e){return console.error("Error getting video ID:",e),null}},observe_video_id=()=>{const e=get_video_id(location.href);e&&window.video_id!==e&&(window.video_id=e,window.dispatchEvent(new Event("onVideoIdChange")))},window.addEventListener("onProgressChangeFinish",observe_video_id),waitElem=e=>new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const o=new MutationObserver((()=>{document.querySelector(e)&&(o.disconnect(),t(document.querySelector(e)))}));o.observe(document.body,{childList:!0,subtree:!0})})),formatNumber=e=>{const t=["K","M","B","T"];let o=-1;for(;e>=1e3&&o<t.length-1;)e/=1e3,o++;return-1===o?e:e.toFixed(1)+t[o]},add_dislike_counts=()=>{fetch(`https://returnyoutubedislikeapi.com/votes?videoId=${get_video_id(location.href)}`).then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{let t=e.dislikes;waitElem(".YtDislikeButtonViewModelHost").then((e=>{e.querySelector("button").style.width="auto",e.querySelector(".yt-spec-button-shape-next__icon").style.marginRight="6px";let o=document.createElement("div");o.classList.add("yt-spec-button-shape-next__button-text-content"),o.textContent=formatNumber(t),e.querySelector("yt-touch-feedback-shape").appendChild(o)}))}))},window.addEventListener("onVideoIdChange",add_dislike_counts),window.originalFetch||(window.originalFetch=fetch,fetch=async(...e)=>{const t=e[0].url;if(t&&t.includes("youtubei/v1/player")){const t=await window.originalFetch(...e),o=await t.json(),n=["playerAds","adPlacements","adBreakHeartbeatParams","adSlots"];for(const e of n)o.hasOwnProperty(e)&&delete o[e];return new Response(JSON.stringify(o),{status:t.status,headers:t.headers})}return window.originalFetch(...e)}),set_quality=()=>{const e=document.getElementById("movie_player");if("watch"===get_page_class(location.href)){const t=localStorage.getItem("video_quality")||"default";-1!==e.getAvailableQualityLevels().indexOf(t)&&e.setPlaybackQualityRange(t)}},save_quality=e=>{const t=e.target;(t.id.startsWith("player-quality-dropdown")||t.classList.contains("player-quality-settings"))&&(console.log("video quality setting changed"),localStorage.setItem("video_quality",document.getElementById("movie_player").getPlaybackQuality()))},document.addEventListener("change",save_quality),window.addEventListener("onVideoIdChange",set_quality),window.addEventListener("onRefresh",(()=>{window.location.reload()})),window.addEventListener("onProgressChangeFinish",(()=>{android.finishRefresh()})),window.addEventListener("doUpdateVisitedHistory",(()=>{const e=get_page_class(location.href);"home"===e||"subscriptions"===e||"library"===e||"@"===e?android.setRefreshLayoutEnabled(!0):android.setRefreshLayoutEnabled(!1)}));new MutationObserver((e=>{for(const t of e)"childList"===t.type&&t.addedNodes.forEach((e=>{1===e.nodeType&&e.classList.contains("video-stream")&&e.addEventListener("timeupdate",(()=>{0!==e.currentTime&&localStorage.setItem("progress-"+get_video_id(location.href),e.currentTime.toString())})),"movie_player"===e.id&&(window.last_player_state=-1,e.addEventListener("onStateChange",(t=>{if([1,3].includes(t)&&-1===window.last_player_state&&"watch"===get_page_class(location.href)){const t=localStorage.getItem("progress-"+get_video_id(location.href))||"0";e.seekTo(parseInt(t))}window.last_player_state=t})))}))})).observe(document.documentElement,{childList:!0,subtree:!0}),window.injected=!0}}catch(e){throw console.error(e),e}